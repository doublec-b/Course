import{aA as m,ap as _,l as w,o as C,n as k,p,$ as i,a0 as a,a4 as E,aw as d,av as F,ax as y,ay as I,y as u,az as v,at as P,au as $,as as z}from"./index-62229c44.js";import{c as A}from"./cloneDeep-af9ad142.js";const L=e=>m.request({url:"api/building/page",method:"post",data:e}),U=e=>m.request({url:"api/building/delete",params:e}),W=e=>m.request({url:"api/building/add",method:"post",data:e}),q=e=>m.request({url:"api/building/edit",method:"post",data:e}),B=w({data(){return{buildings:[],building:{colums:[],current:0,size:0},dialogFormVisible:!1,building:{chager:0,id:0,name:"",schoolId:0},formLabelWidth:80}},mounted(){this.getbuildingsPage(1)},methods:{toEdit(e){console.log(e),this.dialogFormVisible=!0,this.building=A(e)},getbuildingsPage(e){L({current:e,size:10}).then(t=>{console.log(t);const b=t.data.page;this.buildings=b.records,this.page=b}).catch(t=>{console.log(t)})},currentchange(e){this.getbuildingsPage(e),this.page.current=e},del(e){console.log(e),U({id:e}).then(t=>{if(t.success)this.getbuildingsPage(this.page.current),this.page.total%this.page.size==1?this.getAdCatesPage(this.page.current-1):this.getAdCatesPage(this.page.current);else return console.log(t.msg),!1}).catch(t=>{})},toAdd(){this.dialogFormVisible=!0,this.building={chager:0,id:0,name:"",schoolId:0}},save(){const e=this.building;e.id==0?W(e).then(l=>{if(l.success)this.dialogFormVisible=!1,this.getbuildingsPage(this.page.current),d(l.msg);else return d(l.msg),!1}).catch(l=>{d("网络错误联系管理员")}):q(e).then(l=>{if(l.success)this.dialogFormVisible=!1,this.getbuildingsPage(this.page.current),d(l.msg);else return d(l.msg),!1}).catch(l=>{d("网络错误联系管理员")})}}}),N={class:"buildings"},T={class:"building-tools"},D={class:"dialog-footer"};function S(e,l,t,b,M,j){const n=F,s=v,h=y,r=P,g=$,c=z,f=I;return C(),k(E,null,[p("div",N,[p("div",T,[i(n,{type:"warning",onClick:e.toAdd},{default:a(()=>[u("添加")]),_:1},8,["onClick"])]),i(h,{data:e.buildings,style:{width:"100%"}},{default:a(()=>[i(s,{fixed:"",prop:"id",label:"序号",width:"50"}),i(s,{prop:"chager",label:"楼管"}),i(s,{prop:"id",label:"宿舍楼编号"}),i(s,{prop:"name",label:"宿舍楼名称"}),i(s,{prop:"schoolId",label:"SchoolId"}),i(s,{fixed:"right",label:"操作",width:"120"},{default:a(o=>[i(n,{link:"",type:"primary",size:"small",onClick:V=>e.toEdit(o.row)},{default:a(()=>[u("更新")]),_:2},1032,["onClick"]),i(n,{link:"",type:"primary",size:"small",onClick:V=>e.del(o.row.id)},{default:a(()=>[u("删除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])]),i(f,{modelValue:e.dialogFormVisible,"onUpdate:modelValue":l[5]||(l[5]=o=>e.dialogFormVisible=o),title:"楼栋编辑"},{footer:a(()=>[p("span",D,[i(n,{onClick:l[4]||(l[4]=o=>e.dialogFormVisible=!1)},{default:a(()=>[u("Cancel")]),_:1}),i(n,{type:"primary",onClick:e.save},{default:a(()=>[u("保存")]),_:1},8,["onClick"])])]),default:a(()=>[i(c,{model:e.building},{default:a(()=>[i(g,{label:"SchoolId","label-width":e.formLabelWidth},{default:a(()=>[i(r,{modelValue:e.building.schoolId,"onUpdate:modelValue":l[0]||(l[0]=o=>e.building.schoolId=o),autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label-width"]),i(g,{label:"楼管","label-width":e.formLabelWidth},{default:a(()=>[i(r,{modelValue:e.building.chager,"onUpdate:modelValue":l[1]||(l[1]=o=>e.building.chager=o),autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label-width"]),i(g,{label:"宿舍楼编号","label-width":e.formLabelWidth},{default:a(()=>[i(r,{modelValue:e.building.id,"onUpdate:modelValue":l[2]||(l[2]=o=>e.building.id=o),autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label-width"]),i(g,{label:"宿舍楼名称","label-width":e.formLabelWidth},{default:a(()=>[i(r,{modelValue:e.building.name,"onUpdate:modelValue":l[3]||(l[3]=o=>e.building.name=o),autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label-width"])]),_:1},8,["model"])]),_:1},8,["modelValue"])],64)}const J=_(B,[["render",S]]);export{J as default};
